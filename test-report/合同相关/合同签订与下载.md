+ 测试人员：颜番
+ 测试时间：2019.09.08
+ 测试平台：windows10, python3.6, mysql 8.0.17, flask1.1.1
+ 接口url: /contract/sign, /contract/download
+ 方法：POST
+ 测试版本：demo  d4e29ecba8b4a30cacb9f883c0107d9c7e901eb3

## 测试内容
### 签订接口测试
测试前向数据库中添加用户数据，用户注册时会自动向第三方数字证书服务器发送注册报文，从而拥有公私钥。
```python
user1 = IndividualUser.IndividualUser(
    nickname='Lucy', password='123', sex='female',
    name='Lucy', birth='1996.01.01', residence_address='Nanjing University',
    education='bachelor', school='NJU', work_address='NJU',
    live_address='NJU', marriage='married', salary='3000',
    vehicle_property='300000', house_property='0', vehicle_loan='0', house_loan='0',
    work_year='3', job='whiteCollar'
)
company3 = EnterpriseUser.EnterpriseUser("Dio面包坊", "123", "19960901", 13, "Dio Brando", 13, "0.11", "0.35", "埃及", "www.ningenoyameruzo.com", "120", "你记得自己吃过多少片面包吗")
```
先调用/contract/uploadText上传一份合同，借款人为Mike，放贷公司为Dio面包坊, contract_id为2。
然后调用sign接口，发送报文
```
user_name:Mike
user_type:individual
contract_id:2
user_passwd:123
```
验证passwd之后，会向第三方数字证书机构发送数字摘要，机构返回签名，返回response为：
```
{
    "content": {
        "analyze_state": "No",
        "enterprise_name": "Dio面包坊",
        "id": 2,
        "individual_name": "Mike",
        "loan_record_id": null,
        "sign_state": "Individual",
        "title": "Lucy借钱"
    },
    "message": "",
    "success": true
}
```
可见签订成功，sign_state已经变为Individual，表示已经个人用户已经签订。

再调用一次接口，让企业进行签订操作：
```
{
    user_name:Dio面包坊
    user_type:enterprise
    contract_id:2
    user_passwd:123
}
```
返回值为
```
{
    "content": {
        "analyze_state": "No",
        "enterprise_name": "Dio面包坊",
        "id": 2,
        "individual_name": "Mike",
        "loan_record_id": null,
        "sign_state": "BothSign",
        "title": "Lucy借钱"
    },
    "message": "",
    "success": true
}
```
成功签订.

如果密码错误，即发送报文：
```
{
    user_name:Dio面包坊
    user_type:enterprise
    contract_id:2
    user_passwd:1234
}
```
收到回复为：
```
{
    "content": null,
    "message": "用户密码错误",
    "success": false
}
```
符合预期
### 下载接口测试
尝试下载上文的合同，调用接口/contract/download, header中contract_id为2
收到的返回值为合同的txt文本，其中尾部包含了企业和个人用户的数字签名，可以用于向第三方验证。

## 测试发现的问题及改进
暂无